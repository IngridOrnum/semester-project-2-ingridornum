import{A as m,a as p,b as f}from"./constants-DCVSafgH.js";async function h(e,n=12,t=1){const a=new URLSearchParams({q:e,limit:n,page:t}),r=await fetch(`${m}/search?${a.toString()}`);if(!r.ok)throw new Error(`Error fetching search data: ${r.status}`);const g=await r.json();return{listings:g.data||[],meta:g.meta||{}}}async function y(e=12,n=1){const t=new URLSearchParams({limit:e,page:n}),a=await fetch(`${m}?${t.toString()}`);if(!a.ok)throw new Error(`Error fetching data: ${a.status}`);const r=await a.json();return{listings:r.data||[],meta:r.meta||{}}}async function w(){const e=localStorage.getItem("accessToken");if(e)return e;throw new Error("AccessToken or username not found")}async function E(e){const n=await w(),t={headers:{"X-Noroff-API-Key":f,Authorization:`Bearer ${n}`,"Content-Type":"application/json"}},a=await fetch(`${p}/${e}`,t);if(!a.ok)throw console.error("Failed to fetch profile data:",a),new Error(`Error fetching profile data: ${a.status}`);return await a.json()}let o=1;const d=12;let s="",l=[],i={};async function c(e=1,n=""){try{let t;n.trim()?(t=await h(n,d,e),l=t.listings||[],i=t.meta||{}):(console.log("Fetching default paginated listings."),t=await y(d,e),l=t.listings||t.data||[],i=t.meta||{}),u(l),P(i),I(i)}catch(t){console.error("Error displaying listings:",t),u([])}}function u(e){const n=document.querySelector(".listings-container");if(n.innerHTML="",e.length===0){n.innerHTML="<p>No listings found.</p>";return}e.forEach(t=>{const a=document.createElement("li");a.classList.add("li-single-listing"),a.setAttribute("data-id",t.id),a.innerHTML=`
            <div class="li-single-listing-content">
                <img src="${t.media?.[0]?.url||""}" alt="${t.media?.[0]?.alt||"No image"}">
                <span>${t.title}</span>
            </div>
        `,n.appendChild(a)})}function P(e){const n=document.getElementById("prevPage"),t=document.getElementById("nextPage");n.disabled=!e.previousPage,t.disabled=!e.nextPage}function I(e){const n=document.getElementById("paginationCount"),t=Math.min(e.currentPage*d,e.totalCount);n.innerHTML=`
        <span>Showing ${t} of ${e.totalCount}</span>
    `}document.getElementById("prevPage").addEventListener("click",()=>{i.previousPage&&(o=i.previousPage,c(o,s))});document.getElementById("nextPage").addEventListener("click",()=>{i.nextPage&&(o=i.nextPage,c(o,s))});document.getElementById("searchInput").addEventListener("input",async e=>{s=e.target.value,o=1,await c(o,s)});document.getElementById("loginBtn").addEventListener("click",()=>{window.location="auth/login/index.html"});document.getElementById("registerBnt").addEventListener("click",()=>{window.location="auth/register/index.html"});async function v(){const e=localStorage.getItem("loggedInUsername");if(e)try{const n=await E(e),t=document.getElementById("user-display-nav");t&&(t.innerHTML=`
                <img src="${n.data.avatar.url||"/default-avatar.png"}" alt="User Avatar" style="width:40px; height:40px; border-radius:50%;">
                    <span>${n.data.name}</span>
                `)}catch(n){console.error("Error displaying user profile:",n)}}v();c(o);
