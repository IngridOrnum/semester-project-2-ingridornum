import{d as i,b as r}from"./constants-CygYw0oH.js";async function c(){const e=localStorage.getItem("accessToken");if(e)return e;throw new Error("AccessToken or username not found")}async function l(e){const a=await c(),n={method:"GET",headers:{"X-Noroff-API-Key":r,Authorization:`Bearer ${a}`,"Content-Type":"application/json"}},t=await fetch(`${i}/${e}`,n);if(!t.ok)throw console.error("Failed to fetch profile data:",t),new Error(`Error fetching profile data: ${t.status}`);return await t.json()}async function d(){const e=localStorage.getItem("loggedInUsername"),a=document.getElementById("logoutBtn"),n=document.getElementById("loginBtn"),t=document.getElementById("registerBnt");if(e){n&&n.classList.add("hidden"),t&&t.classList.add("hidden"),a&&a.classList.remove("hidden");try{const o=await l(e),s=document.getElementById("user-display-nav");s&&(s.innerHTML=`
<span>Your credits: ${o.data.credits}</span>
<div id="my-profile" class="flex gap-2.5 items-center cursor-pointer">
<span>${o.data.name}</span>
<img src="${o.data.avatar.url||"/default-avatar.png"}" alt="User Avatar" style="width:40px; height:40px; border-radius:50%;">
</div> 
                `)}catch(o){console.error("Error displaying user profile:",o)}}else{n&&(n.classList.remove("hidden"),n.classList.add("block")),t&&(t.classList.remove("hidden"),t.classList.add("block")),a&&a.classList.add("hidden");const o=document.getElementById("user-display-nav");o&&(o.innerHTML="")}}async function u(){document.body.addEventListener("click",e=>{e.target.closest("#my-profile")&&(window.location.href="../../../../profile/index.html")})}function g(){localStorage.removeItem("accessToken"),localStorage.removeItem("loggedInUsername"),alert("You logged out!"),location.reload()}function f(){const e=document.getElementById("logoutBtn");if(!e){console.log("No logout button found");return}e.addEventListener("click",function(){g()})}function m(){localStorage.accessToken||(alert("Please login to view and bid on listings"),window.location.href="/auth/login/")}async function p(){d(),f(),u()}p();m();export{c as g,l as r};
